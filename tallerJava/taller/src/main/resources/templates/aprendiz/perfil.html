<!DOCTYPE html>
<html lang="es"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/mainA}">
<head>
    <title layout:fragment="title">Mi Perfil</title>
</head>

<body>
<div layout:fragment="content">
    <section id="perfil-section" class="content-section active-section" aria-labelledby="perfil-heading">

        <div class="section-header">
            <div>
                <h2 id="perfil-heading">Mi Perfil</h2>
                <p class="section-subtitle">Consulta tu informaci√≥n y actualiza tu foto</p>
            </div>
        </div>

        <div class="profile-card">
            <div class="profile-grid">
                <div class="profile-item">
                    <div class="profile-label">Nombre completo</div>
                    <div class="profile-value" th:text="${usuario.nombre + ' ' + usuario.apellido}">Nombre Apellido</div>
                </div>

                <div class="profile-item">
                    <div class="profile-label">Correo</div>
                    <div class="profile-value" th:text="${usuario.correo}">correo@ejemplo.com</div>
                </div>

                <div class="profile-item">
                    <div class="profile-label">Rol</div>
                    <div class="profile-value">Aprendiz</div>
                </div>

                <div class="profile-item">
                    <div class="profile-label">Ficha</div>
                    <div class="profile-value"
                         th:text="${usuario.ficha != null} ? ${usuario.ficha.numeroFicha} : 'No asignada'">No asignada</div>
                </div>
            </div>

            <div class="form-actions" style="margin-top: 16px;">
                <button class="btn btn-modern btn-primary" id="miPerfilEditarBtn" type="button">Cambiar foto</button>
            </div>

            <form id="profileForm" th:action="@{/aprendiz/actualizarPerfil}" method="POST"
                  enctype="multipart/form-data" style="display:none;">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <input type="file" name="foto_perfil" id="foto_perfil" accept="image/*" onchange="this.form.submit()">
            </form>
        </div>

        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const editarBtn = document.getElementById('miPerfilEditarBtn');
                if (editarBtn) {
                    editarBtn.addEventListener('click', function() {
                        document.getElementById('foto_perfil').click();
                    });
                }
            });
        </script>

    </section>
</div>
</body>
</html>
