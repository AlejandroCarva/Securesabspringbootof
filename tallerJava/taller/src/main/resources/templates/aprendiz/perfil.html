<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/mainA}">
<head>
    <title>Mi Perfil</title>
    <style>
        .profile-details {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
        }
        
        .profile-info-group {
            flex: 1;
        }
        
        .profile-info-group p {
            margin-bottom: 0.75rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .profile-actions {
            margin-top: 1.5rem;
        }
        
        .hidden-form {
            display: none;
        }
    </style>
</head>
<body>
    <div layout:fragment="content">
        <section class="content-section-standard">
            <h2>Mi Perfil</h2>
            
            <div class="profile-details">
                <div class="profile-info-group">
                    <p><strong>Nombre Completo:</strong> 
                       <span th:text="${usuario.nombre + ' ' + usuario.apellido}">Nombre Apellido</span>
                    </p>
                    <p><strong>Correo Electr√≥nico:</strong> 
                       <span th:text="${usuario.correo}">correo@ejemplo.com</span>
                    </p>
                </div>
                <div class="profile-info-group">
                    <p><strong>Rol:</strong> 
                       <span>Aprendiz</span>
                    </p>
                    <p><strong>Ficha:</strong> 
                       <span th:text="${usuario.ficha != null} ? ${usuario.ficha.numeroFicha} : 'No asignada'">No asignada</span>
                    </p>
                </div>
            </div>
            
            <div class="profile-actions">
                <button class="btn primary-btn" id="miPerfilEditarBtn">Cambiar Foto de Perfil</button>
            </div>

            <!-- Formulario oculto para subir foto de perfil -->
            <form id="profileForm" th:action="@{/aprendiz/actualizarPerfil}" method="POST" 
                  enctype="multipart/form-data" class="hidden-form">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <input type="file" name="foto_perfil" id="foto_perfil" accept="image/*" 
                       onchange="this.form.submit()">
            </form>
        </section>

        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const editarBtn = document.getElementById('miPerfilEditarBtn');
                if (editarBtn) {
                    editarBtn.addEventListener('click', function() {
                        document.getElementById('foto_perfil').click();
                    });
                }
            });
        </script>
    </div>
</body>
</html>