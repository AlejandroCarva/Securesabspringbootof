<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      lang="es"
      layout:decorate="~{layouts/mainV}">

<head>
    <meta charset="UTF-8">
    <title layout:fragment="title">Registrar Invitado - Vigilante</title>

    <!-- Estilos específicos para esta pantalla -->
    <th:block layout:fragment="extraHead">
        <style>
            /* YA NO ponemos color blanco a toda la sección */
            .content-section {
                /* si quieres espacio superior extra, puedes usar: */
                /* padding-top: 10px; */
            }

            .section-header {
                display: flex;
                flex-direction: column;
                gap: 6px;
                margin-bottom: 18px;
            }

            .section-header h1 {
                font-size: 26px;
                font-weight: 700;
                margin: 0;
                color: #14532d;          /* VERDE OSCURO BIEN VISIBLE */
            }

            .section-header p {
                margin: 0;
                font-size: 14px;
                color: #4b5563;          /* Gris legible */
            }

            .section-header a {
                margin-top: 6px;
                font-size: 14px;
                text-decoration: none;
                display: inline-flex;
                align-items: center;
                gap: 6px;
                color: #14532d;
                font-weight: 500;
            }

            .section-header a i {
                font-size: 16px;
            }

            /* Tarjeta del formulario */
            .form-card {
                margin-top: 8px;
                background: #ffffff;
                border-radius: 14px;
                padding: 24px 24px 20px;
                color: #111827;
                box-shadow: 0 8px 18px rgba(0, 0, 0, 0.15);
                max-width: 900px;
            }

            .form-card h2 {
                margin: 0 0 4px;
                font-size: 20px;
                font-weight: 700;
                color: #14532d;
            }

            .form-card .subtitle {
                margin: 0 0 18px;
                font-size: 13px;
                color: #64748b;
            }

            .form-grid {
                display: grid;
                grid-template-columns: repeat(2, minmax(0, 1fr));
                gap: 18px 22px;
            }

            .form-group {
                display: flex;
                flex-direction: column;
            }

            .form-group.full {
                grid-column: 1 / -1;
            }

            .form-group label {
                font-size: 13px;
                font-weight: 600;
                margin-bottom: 4px;
                color: #111827;
            }

            .form-group input,
            .form-group select,
            .form-group textarea {
                border-radius: 8px;
                border: 1px solid #d1d5db;
                padding: 9px 11px;
                font-size: 14px;
                outline: none;
                transition: border-color .18s, box-shadow .18s, transform .08s;
            }

            .form-group textarea {
                min-height: 70px;
                resize: vertical;
            }

            .form-group input:focus,
            .form-group select:focus,
            .form-group textarea:focus {
                border-color: #16a34a;
                box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.25);
            }

            .form-group input[readonly] {
                background-color: #f9fafb;
                color: #6b7280;
            }

            .error-campo {
                margin-top: 4px;
                font-size: 12px;
                color: #b91c1c;
            }

            .form-actions {
                margin-top: 22px;
                display: flex;
                justify-content: flex-end;
                gap: 10px;
            }

            .btn-modern {
                border-radius: 999px;
                border: none;
                padding: 9px 18px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
                display: inline-flex;
                align-items: center;
                gap: 7px;
                transition: transform .08s ease-out,
                box-shadow .16s ease-out,
                background-color .18s ease-out;
            }

            .btn-modern i {
                font-size: 14px;
            }

            .btn-outline {
                background: #ffffff;
                color: #374151;
                border: 1px solid #d1d5db;
            }

            .btn-outline:hover {
                background: #f3f4f6;
                box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
                transform: translateY(-1px);
            }

            .btn-primary {
                background: linear-gradient(135deg, #16a34a, #166534);
                color: #ffffff;
                box-shadow: 0 4px 10px rgba(16, 185, 129, 0.45);
            }

            .btn-primary:hover {
                background: linear-gradient(135deg, #15803d, #14532d);
                box-shadow: 0 6px 14px rgba(16, 185, 129, 0.58);
                transform: translateY(-1px);
            }

            .alerta {
                display: flex;
                align-items: center;
                gap: 8px;
                border-radius: 999px;
                padding: 8px 14px;
                font-size: 13px;
                margin-bottom: 10px;
                width: fit-content;
            }

            .alerta-exito {
                background: #dcfce7;
                color: #166534;
            }

            .alerta-error {
                background: #fee2e2;
                color: #b91c1c;
            }

            .alerta i {
                font-size: 15px;
            }

            @media (max-width: 768px) {
                .form-card {
                    padding: 18px 16px;
                }

                .form-grid {
                    grid-template-columns: 1fr;
                }

                .section-header h1 {
                    font-size: 20px;
                }
            }
        </style>
    </th:block>

</head>

<body>

<!-- OJO: todo el contenido va dentro de este fragmento,
     que reemplaza el <div layout:fragment="content"> del layout mainV -->
<div class="content-section active-section" layout:fragment="content">

    <div class="section-header">
        <h1>Registrar nuevo invitado</h1>
        <p>Completa los datos del visitante y guarda el registro.</p>

        <a th:href="@{/vigilante/consultar-invitados}">
            <i class="fa-solid fa-users"></i>
            <span>Ver invitados</span>
        </a>
    </div>

    <!-- Alertas opcionales -->
    <div th:if="${success != null}" class="alerta alerta-exito">
        <i class="fa-solid fa-circle-check"></i>
        <span th:text="${success}">Registro creado correctamente</span>
    </div>

    <div th:if="${error != null}" class="alerta alerta-error">
        <i class="fa-solid fa-circle-xmark"></i>
        <span th:text="${error}">Ocurrió un error</span>
    </div>

    <!-- Tarjeta con el formulario -->
    <div class="form-card">
        <h2>Datos del invitado</h2>
        <p class="subtitle">
            Ingresa la información básica del visitante y el motivo de la visita.
        </p>

        <form th:action="@{/vigilante/registrar-invitados}"
              th:object="${visitante}"
              method="post">

            <input type="hidden" name="idUsuario"
                   th:value="${idUsuarioVigilante}"/>

            <div class="form-grid">
                <!-- Nombre -->
                <div class="form-group">
                    <label for="nombre">Nombre</label>
                    <input id="nombre" type="text" th:field="*{nombre}" required>
                    <div class="error-campo"
                         th:if="${#fields.hasErrors('nombre')}"
                         th:errors="*{nombre}"></div>
                </div>

                <!-- Apellido -->
                <div class="form-group">
                    <label for="apellido">Apellido</label>
                    <input id="apellido" type="text" th:field="*{apellido}" required>
                    <div class="error-campo"
                         th:if="${#fields.hasErrors('apellido')}"
                         th:errors="*{apellido}"></div>
                </div>

                <!-- Cédula -->
                <div class="form-group">
                    <label for="cedula">Cédula</label>
                    <input id="cedula" type="text" th:field="*{cedula}" required>
                    <div class="error-campo"
                         th:if="${#fields.hasErrors('cedula')}"
                         th:errors="*{cedula}"></div>
                </div>

                <!-- Motivo -->
                <div class="form-group">
                    <label for="motivo">Motivo</label>
                    <select id="motivo" th:field="*{motivo}" required>
                        <option value="">Seleccione...</option>
                        <option value="Reunión">Reunión</option>
                        <option value="Entrega">Entrega</option>
                        <option value="Visita personal">Visita personal</option>
                    </select>
                    <div class="error-campo"
                         th:if="${#fields.hasErrors('motivo')}"
                         th:errors="*{motivo}"></div>
                </div>

                <!-- Observaciones (NO ligado al entity para evitar el error) -->
                <div class="form-group full">
                    <label for="observaciones">Observaciones</label>
                    <textarea id="observaciones"
                              name="observaciones"
                              placeholder="Notas adicionales sobre la visita (opcional)"></textarea>
                </div>

                <!-- Fecha -->
                <div class="form-group">
                    <label for="fechaEntrada">Fecha de Entrada</label>
                    <input id="fechaEntrada" type="text" th:value="${fechaHoy}" readonly>
                </div>

                <!-- Hora -->
                <div class="form-group">
                    <label for="horaEntrada">Hora de Entrada</label>
                    <input id="horaEntrada" type="text" th:value="${horaAhora}" readonly>
                </div>
            </div>

            <div class="form-actions">
                <button type="reset" class="btn-modern btn-outline">
                    <i class="fa-solid fa-eraser"></i>
                    <span>Limpiar</span>
                </button>

                <button type="submit" class="btn-modern btn-primary">
                    <i class="fa-solid fa-user-plus"></i>
                    <span>Registrar Invitado</span>
                </button>
            </div>
        </form>
    </div>
</div>

</body>
</html>
